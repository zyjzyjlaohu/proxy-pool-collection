# 增强版代理收集工具

这是一个基于Fofa API的增强版代理收集工具，能够通过多种搜索语法自动收集更多可用的代理。

## 功能特点

1. **多语法搜索**：集成了多种搜索语法，包括原始SOCKS5无认证代理和用户提供的新语法
2. **去重处理**：自动去除重复的代理条目
3. **多层筛选**：先进行端口开放检测，再进行实际可用性测试
4. **多URL测试**：使用多个网站测试代理有效性，提高准确性
5. **认证支持**：尝试使用用户名和密码字典进行认证代理测试
6. **并发处理**：使用线程池提高处理速度
7. **统计报告**：生成详细的统计信息，包括代理总数、开放端口数和有效代理数

## 使用方法

1. 确保已安装必要的依赖：
```bash
pip install requests
```

2. 运行工具：
```bash
python enhanced_proxy_collector.py
```

## 配置参数说明

在脚本开头的`CONFIG`字典中可以修改以下配置：

- `fofa_email`：Fofa账号的邮箱（已预设）
- `fofa_key`：Fofa API Key（已预设）
- `output_dir`：输出文件的保存目录
- `max_workers`：最大线程数，默认为100
- `connect_timeout`：端口连接超时时间（秒）
- `test_timeout`：代理测试超时时间（秒）
- `search_queries`：搜索语法列表，包含多种代理相关的搜索条件
- `test_urls`：用于测试代理有效性的URL列表

## 输出文件说明

1. **enhanced_fofa_results.txt**：从Fofa爬取的原始代理数据（去重后）
2. **enhanced_open_ports.txt**：端口开放的代理列表
3. **enhanced_valid_proxies.txt**：最终验证有效的代理列表，格式为`SOCKS5://IP:端口`或`SOCKS5://用户名:密码@IP:端口`

## 工作流程

1. **数据爬取**：使用配置的搜索语法从Fofa API获取代理数据并去重
2. **端口检测**：测试每个代理的端口是否开放
3. **有效性验证**：对端口开放的代理进行实际连接测试，包括无密码和带认证两种方式

## 注意事项

1. Fofa API有调用限制，请合理使用
2. 工具会消耗一定的网络带宽，建议在网络条件较好的环境下运行
3. 代理的有效性会随时间变化，建议定期更新代理列表
4. 免费代理的稳定性和速度可能不如付费代理，请根据实际需求选择使用

## 自定义扩展

1. 可以在`search_queries`列表中添加更多搜索语法
2. 可以在`test_urls`列表中添加更多测试网站
3. 可以修改`user.txt`和`pass.txt`文件来更新用户名密码字典

## 统计信息

工具运行完成后会显示以下统计信息：
- 总爬取代理数
- 端口开放数
- 有效代理数
- 有效率百分比

希望这个工具能帮助您收集到更多可用的代理！
